# **Отчет о работе**

## 1. [Уточненная постановка задачи для назначенного варианта задания](doc/SpecificTask.md)

## 2. [Диаграмма классов программной системы](https://github.com/user-attachments/files/17393576/default.pdf)

## 3. Текстовые спецификации основных классов системы
### BackEnd
- **Building** – Базовый класс зданий, является абстрактным. Содержит следующие поля: длительность стройки(в месяцах), стоимость стройки 1 месяца, владелец — указатель на Player, район, в котором находится здание — указатель на Microdistric, ID, процент готовности (постройки) здания.
- **House** – Класс жилого дома, наследованный от Building. Содержит следующие поля: тип дома (монолитный, панельный, кирпичный), общее количество квартир, количество проданных квартир, количество квартир, выставленных на продажу, цена одной квартиры, прибыль с дома. От типа дома зависят длительность стройки, месячная плата, количество квартир в нем.
- **Shop** – Класс магазина, наследованный от Building. Имеет следующие поля: Тип магазина (супермаркет, пекарня, строительный магазин), прибыль с магазина. Длительность строительства, месячная плата и уровень продаж зависят от типа магазина. Строительный магазин демонстрирует высокий уровень продаж при успешной продаже квартир, а пекарня не приносит прибыли без наличия супермаркета в районе.
- **Player** – Базовый класс игрока. Используется для игрока-человека. Содержит следующие поля: Имя, возраст, пол, количество денег, дома — массив указателей на Building, магазины — массив указателей на Building, район — указатель на Microdistrict, траты на рекламу магазинов, траты на рекламу домов в текущем и предыдущем месяце (это нужно для осуществления действия рекламы в течение двух месяцев).
- **Bot** — Класс ботов, наследованный от Player. Содержит поле, обозначающее стратегию игрока-бота (1, 2, 3). Для ботов были выбраны следующие стратегии:
  - *GalinaBot* - «Сбалансированные инвестиции». Тратит 60% денег на постройку домов, 30% - на постройку магазинов, 10% - на рекламу, из которых 50% идет на рекламу домов, 50% идет на рекламу магазинов.
  - *IvanBot* - «Агрессивное строительство». Тратит 75% денег на постройку домов, 15% - на постройку магазинов. 10% тратит на рекламу, из которых всё идет на рекламу домов.
  - *EdwardBot* - «Фокус на магазинах». Тратит 40% на постройку домов, 50% на постройку магазинов, 10% на рекламу, из которых всё идет на рекламу магазинов.
- **Microdistrict** – Класс района. Содержит следующие поля: имя (Арбат, Сокольники, Гагарин), все магазины, находящиеся в этом районе — массив указателей на Building, Все дома, находящиеся в этом районе — массив указателей на Building, спрос на квартиры в данном районе, средний уровень продаж в магазинах этого района. Количество магазинов влияет на спрос квартир, количество проданных квартир влияет на уровень продаж в магазинах.
- **Game** – Основной класс игры. Содержит следующие поля: Текущий месяц, начальный месяц, все игроки, включая ботов — массив указателей на Player, все боты — массив указателей на Player (является подмножеством всех игроков), все здания — массив указателей на Building, все районы — массив указателей на Microdistrict. Принимает с frontend-а строку формата json, парсит её и создает все необходимые объекты классов, описанных выше. Далее вызываются следующие методы:
  - *bots_make_step()*  - Все боты делают ход, то есть заполняют данные, следуя своим стратегиям, описанным выше.
  - *players_pay_month_construction()* - происходит оплата строительства зданий за этот месяц. Для каждого игрока сортируется массив его домов по тому, сколько осталось месяцев до конца постройки, если эта величина равная, то сравниваются по ценам. Это нужно для того, что если игроку не хватит денег на постройку всех зданий, то он будет строить сначала те здания, которые завершат строительство раньше. Далее у каждого игрока списываются деньги за постройку всех его зданий, кроме уже построенных. Если игроку хватило на постройку здания в этом месяце, то процент готовности здания увеличивается, иначе — нет.
  - *players_get_cash_from_shops()* - Все игроки получают прибыль с магазинов. Для каждого района считается уровень продаж. Он зависит от количества проданных квартир и текущего месяца. Далее каждому игроку начисляются деньги за продажи в магазинах в текущих месяцах. Если магазин в процессе стройки, то игроку за него ничего не начисляется (В недостроенных магазинов не может быть никаких продаж) .Реклама повышает эту величину.
  - *players_get_cash_from_houses()* - Продажа квартир. Для каждого района считается спрос на жилье. Он зависит от количества магазинов в районе, текущего месяца, рекламы, купленной игроками в текущем и предыдущем месяце.  Далее осуществляется продажа квартир. Для каждого района все дома сортируются по цене квартиры (Если предложение повышает спрос, то предложения жилья с более низкой ценой осуществляется в первую очередь). Игрокам начисляются деньги за проданные квартиры в их домах.
  - *convert_to_json()* - Все данные преобразовывает в единую строку формата json и передает её во frontend.

### FrontEnd
- **Room** - Главный класс, содержащий все данные конкретной комнаты, в которой ведется игра. Содержит поля: код комнаты, кол-во людей в комнате (макс), кол-во людей в комнате (в настоящее время), кол-во шагов моделирования (в мес), номер текущего месяца, номер месяца в который началась игра, Map игроков (ключ - String, значение - User).
- **User** - класс, экземпляры которого - игроки и боты. Содержит поля: UID, название района, суммарный капитал игрока, имя, возраст, пол, флаг - была ли отправка данных на конкретном шаге, экземпляр класса Advertisement, Map домов (ключ - String, значение - экземпляр класса House), Map магазинов (ключ - String, значение - экземпляр класса Shop).
- **Advertisement** - класс, хранящий информацию о рекламе. Содержит поля: реклама на магазины, реклама на дома (текущий месяц), реклама на дома (прошлый месяц).
- **House** - класс, хранящий информацию о конкретном дома. Содержит поля: HID, тип дома, срок стройки (в мес), номер месяца начала стройки, стоимость стройки 1 месяца, цена продажи 1 квартиры (на конкретном шаге), кол-во квартир в доме, кол-во проданных квартир, кол-во выставленный на продажу квартир (на конкретном шаге), общая пробыль с дома, процент выполнения стройки, номер постройки.
- **Shop** - класс, хранящий информацию о конкретном магазине. Содержит поля: SID, тип магазина, продолжительность стройки, номер месяца начала стройки, стоимость стройки 1 месяца, общая пробиль с магазина, процент выполнения стройки, номер постройки.

## 4. Указание использованных при выполнении задания инструментальных средств (языка программирования, интегрированной среды, библиотек)
- Языки программирования:
  - ***C++*** (backend)
  - ***Java*** (frontend)
  - ***XML*** (верстка экранов)
- Среды разработки:
  - ***Android Studio*** (для написания front`а и создания версток экранов)
  - ***Visual Studio*** (для написания back`а)
- Библиотеки:
  - ***JNI*** - Java Native Interface (для взаимодействия Java с кодом на C++ в качестве библиотеки)
  - ***nlohmann*** (для работы с json на C++)
  - ***gson*** (для работы с json на Java)
  - ***firebase*** (для работы с Authentication, Realtime Database и Crashlytics)

## 5. Описание файловой структуры программной системы
### 1) **app** (главаня папка в Android)
#### manifests
Содержит файл xml общей информации

  #### 1. *cpp* (папка)
  - backend (папка) - папки с кодом C++
  - json-developer (папка) - библиотека для работы с json на C++
  - native-lib.cpp - библиотека на C++ для вызова ее из Java (связка между Back и Front)

  #### 2. *java* (папка)
  - ConnectRealtimeDatabase - связь с Realtime Database
  - InteractionJSON - связь между Java и библиотекой на C++
  - LoadingActivity - активность экрана загрузки
  - MainBottomNavigation - активность главного меню (с 3мя фрагментами)
  - MainActivity - активность, где проходит сама игра
  - Room (папка)
    - CreateRoomActivity - активность для создания новой игровой комнаты
    - EnterRoomActivity - активность для входа в уже существующую комнату
  - LogicClasses (папка)
    - Advertisement - класс реклама
    - House - класс домов
    - Shop - класс магазинов
    - User - класс пользователей и ботов
    - Room - класс комнаты (содержит в своих полях все вышеперечисленные классы)
  - Authorization (папка)
    - WelcomeActivity - первая активность, которая открывается при запуске приложения
    - SignInActivity - активность для входа в аккаунт
    - CreateAccountActivity - активность для создания аккаунта
  - AdapterState (папка)
    - Construction (папка)
      - ConstructionAdapter - адаптер для RecycleView (просмотр построек)
      - ConstructionState - класс для хранения экземпляров построек (для адапрета)
    - OtherPlayer (папка)
      - PlayerAdapter - адаптер для RecyclerView (просмотр списка других игроков)
      - PlayerState - класс для хранения экземпляров игроков (для адаптера)
    - FinalGame (папка)
      - FinalGameAdapter - адаптер для RecyclerView (просмотр итогового списка игроков)
      - FinalGameState - класс для хранения экземпляров игроков (для адаптера)
  - DialogFragment (папка)
    - AddInfoConstruction - окно для установки кол-ва и цена продаваемых квартир на шаге
    - AdvertisementConstruction - окно для устаноки рекламы на шаге
    - NewConstruction - окно для создания новых строений
    - QuestionAgain - окно (подтверждение) отправки данных на конкретный шаг
  - Fragmenta (папка)
    - EnterRoomFragment - экран при входе к комнате (основной)
    - BottomMenu (папка)
      - FriendsFragment - экран (друзья)
      - HomeFragment - экран (создание/вход комнаты)
      - SettingsFragment экран (настройки аккаунта)
    - MainFragments (папка)
      - LoadingFragment - экран загрузки
      - MainFragment - экран игры (основной)
      - OtherPlayersFragment - экран с другими игроками
      - PlayerFragment - экран с другим игроком (подробная информация о нем)
      - FinalGameFragment - экран с рейтинговой таблицей (конец игры)

  #### 3. *res* (папка)
  Содержит папки с файлами XML (разметка экранов, диалоговый окон, фрагментов, анимаций и тд)

### 2) **Gradle Scripts** (папка)
Содержит файлы настройки и зависимостей Android

## 6. Краткая характеристика пользовательского интерфейса
#### Окно приветствия:
- *get start* - по нажатию открывается окно регистрации
#### Окно входа в аккаунт:
- *email*, *password* - поля ввода
- *sign in* - по нажатию выполняется вход в аккаунт и открывается домашнее окно
- *create Account* - по нажатию открывается окно регистрации аккаунта
#### Окно регистрации:
- *your name*, *email*, *password*, *password again* - поля ввода
- *create account* - по нажатию выполняется регистрация аккаунта и открывается домашнее окно
- *sign in* - по нажатию открывается окно входа в аккаунт
#### Домашнее окно:
- Меню:
  - *friend* - переход на окно с друзьями (в разработке)
  - *home* - переход на окно "домашнее окно"
  - *settings* - переход на окно настроек аккаунта (в разработке)
- *create room* - открывается окно создания комнаты
- *enter room* - открывается окно входа в комнату
#### Окно создания комнаты:
- *кнопка копирования room code* - копирует в буфер код комнаты
- *from 2 to 4*, *number of modeling steps* - поля ввода
- *select a month*, *select a district* - spinner для выбора месяца начала игры и района, в котором начнется игра
- *Bot* - можно поставить галочки на добавления разных ботов в район, указанный при создании комнаты
- *create room* - по нажатию выполняется создание комнаты и переход на "основное игровое окно"
- *detailed settings* - по нажатию открывается диалоговое окно, где можно указать подробные характеристики при создании комнаты (в разработке)
- *back* - по нажатию возврат на "домашнее окно"
#### Окно входа в комнату:
- *enter the room code* - поле ввода
- *select a district* - выбор, в каком районе будет играть игрок
- *enter room* - по нажатию выполняется вход в комнату и переход на "основное игровое окно"
- *back* - по нажатию возврат на "домашнее окно"
#### Окно загрузки:
- работает во время создания комнаты и проверки при входе в комнату
#### Основное игровое окно:
- *menu* - по нажатию открывается боковое меню
- *room code* - нгаписан room code (код доступа в комнату)
- *money* - указано кол-во денег у игрока
- *add construction* - по надатию открывается диалоговое окно для добавления новое постройки
- *advertisement* - по нажатию открывается диалоговое окно для вводения суммы на рекламу на текущем шаге (ракета)
- *step* - по нажатию открывается диалоговое окно для подтверждения отправки данных о шаге в БД
- *RecyclerView* - отображение всех строений игрока, по нажатию открывается диалоговое окно для указания кол-ва и стоимости продаваемых квартир в текущем шаге
#### Боковое меню:
- *me* - по нажатию открывается "основное игровое окно"
- *other players* - по нажатию открывается окно со списоком других игроков
- *exit* - по нажатию выполняется выход из комнаты и возврат на "домашнее окно"
#### Диалоговое окно (добавление новой постройки):
- можно выбрать тип *shop* и *house*, поставить галочку на добавление данной постройки
- *add* - по нажатию выполняется добавление построек и закрытие диалогового окна
#### Дислоговое окно (реклама):
- *on houses*, *on shops* - поля ввода
- *save* - по нажатию сохраняется информация о рекламе на текущий шаг
#### Диалоговое окно (подтверждение):
- *confirm* - по нажатию происходит подтверждение отправки данных о текущем шаге и открывается окно ожидания
#### Диалоговое окно (добавление информации о постройках)
- *progress build*, *full apartment*, *sold apartment* - поля информации
- *apartmnet sale count*, *apartment sale price* - поля ввода
- *save info* - по нажатию добавляется информация о конкретном доме
#### Окно со списоком других игроков:
- *RecyclerView* - по нажатию открывается окно с конкретным игроком
- *back* - по нажатию выполняется возврат на "основное игровое окно"
#### Окно другого игрока:
- *name* - написано имя игрока, информация о котором предоставлена информация
- *RecyclerView* - отображение информации о всех постройках другого игрока
- *back* - по нажатию выполняется возврат на "основное игровое окно"
#### Окно финала игры:
- *RecyclerView* - список со всеми игроками (отсортирован)
- *home* - по нажатию выполняется переход на "домашнее окно"

## 7. Краткое описание проведенного эксперимента
Для выявления выигрышной стратегии мы разработали три бота-игрока, каждый из которых использует свою уникальную тактику:
- **GalinaBot** — стратегия «Сбалансированные инвестиции». Этот бот распределяет свои ресурсы следующим образом: 60% средств направляются на строительство жилых домов, 30% — на магазины, а 10% — на рекламу, которая делится поровну между рекламой жилья и магазинов.
- **IvanBot** — стратегия «Агрессивное строительство». Данный бот выделяет 75% средств на строительство жилых домов, 15% на магазины и 10% на рекламу, при этом вся рекламная кампания сосредоточена на жилье.
- **EdwardBot** — стратегия «Фокус на магазинах». Этот бот распределяет 40% средств на строительство жилых домов, 50% на магазины и 10% на рекламу, полностью ориентированную на магазины.
Для анализа эффективности стратегий было проведено четыре эксперимента-моделирования, которые длились 6, 12, 18 и 24 месяца (игровых ходов). Результаты экспериментов:

|                 **Результаты**                 |
| :--------------------------------------------: |
| :--------: |  1 место  |  2 место  |  3 место  |
| :--------: | :-------: | :-------: | :-------: |
| 6 месяцев  |  IvanBot  | GalinaBot | EdwardBot |
| 12 месяцев | GalinaBot | EdwardBot |  IvanBot  |
| 18 месяцев | GalinaBot | EdwardBot |  IvanBot  |
| 24 месяца  | GalinaBot |  IvanBot  | EdwardBot |

Из таблицы видно, что стратегия IvanBot приносит наибольшую выгоду только в короткосрочной перспективе — в первые 6 месяцев. Это может свидетельствовать о том, что агрессивные инвестиции в жилую недвижимость приносят быстрый доход, но в дальнейшем такая стратегия оказывается менее эффективной.
**GalinaBot**, демонстрируя сбалансированный подход, занимает первое место в большинстве случаев (12, 18 и 24 месяца). Этот бот находит оптимальный баланс между различными направлениями инвестиций, что позволяет ему постепенно накапливать преимущества.
**EdwardBot**, сосредоточенный на магазинах, показал умеренные результаты, занимая вторые и третьи места.
#### Выводы:
1. Сбалансированные стратегии (*GalinaBot*) более эффективны в долгосрочной перспективе по сравнению с агрессивными подходами.
2. Агрессивные стратегии (*IvanBot*) могут быть эффективны на коротких сроках, но несут риск недолговечности успеха.
3. Специализированные стратегии (*EdwardBot*) могут быть эффективны в определенных рыночных условиях, но в данном эксперименте не продемонстрировали наилучших результатов. 

## 8. [Подготовка полного GIT - репозитория проекта на github](https://github.com/sanai1/Investment_in_construction)
